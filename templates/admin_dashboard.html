{% extends 'base.html' %}
{% block content %}
<div class="d-flex align-items-center mb-3">
  <h5 class="mb-0">Data Buku Tamu</h5>
  <div class="ms-auto">
    <a class="btn btn-outline-secondary btn-sm" href="/admin/logout">Logout</a>
  </div>
</div>

<!-- Filter tanggal -->


<form class="row gy-2 gx-2 align-items-end mb-3" method="get">
  <div class="col-auto">
    <label class="form-label">Dari</label>
    <input type="date" class="form-control" name="from" value="{{from_str}}">
  </div>
  <div class="col-auto">
    <label class="form-label">Sampai</label>
    <input type="date" class="form-control" name="to" value="{{to_str}}">
  </div>
  <div class="col-auto">
    <button class="btn btn-warning" type="submit">Filter</button>
    <a class="btn btn-success" href="/admin/export.xlsx?from={{from_str}}&to={{to_str}}">Unduh Excel</a>
  </div>
</form>

<div class="table-responsive">
  <table class="table table-striped table-sm align-middle">
    <thead>
      <tr>
        <th>ID</th>
        <th>NIK</th>
        <th>Nama</th>
        <th>Alamat</th>
        <th>Instansi</th>
        <th>Keperluan</th>
        <th>Nomor HP</th>
        <th>Foto</th>
        <th>Bukti Follow</th>
        <th>Waktu (UTC)</th>
      </tr>
    </thead>
    <tbody>
      {% for g in guests %}
      <tr>
        <td>{{ g.id }}</td>
        <td>{{ g.nik or '-' }}</td>
        <td>{{ g.name }}</td>
        <td>{{ g.address or '-' }}</td>
        <td>{{ g.institution or '-' }}</td>
        <td>{{ g.purpose }}</td>
        <td>{{ g.phone or '-' }}</td>
        <td>
          {% if g.photo_filename %}
            <a href="/media/{{ g.photo_filename }}" target="_blank">Lihat</a>
          {% else %}-{% endif %}
        </td>
        <td>
          {% if g.follow_proof %}
            <a href="/media/{{ g.follow_proof }}" target="_blank">Lihat</a>
          {% else %}-{% endif %}
        </td>
        <td>{{ g.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
